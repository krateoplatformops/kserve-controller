apiVersion: ai.krateo.io/v1
kind: InferenceConfig
metadata:
  name: example-inference-config-triton
  namespace: kserve-controller-system
spec:
  autoDeletePolicy: None
  image: ghcr.io/krateoplatformops/kserve-krateo-runner:0.1.0
  kserve:
    modelName: sklearn-iris
    modelUrl: kserve-krateo-ttm-predictor.kserve-test.svc.cluster.local/v2/models/granite-timeseries-ttm-r2/infer
    modelVersion: v2
    modelInputName: past_values
  storage:
    input:
      krateo:
        api:
          endpointRef: 
            name: finops-database-handler-endpoint
            namespace: kserve-controller-system
          path: /compute/tritoninput
          verb: POST
          headers:
          - 'Accept: application/json'
          - 'Content-Type: application/json'
    output:
      krateo:
        api:
          endpointRef: 
            name: finops-database-handler-endpoint
            namespace: kserve-controller-system
          path: /compute/tritonoutput
          verb: POST
          headers:
          - 'Accept: application/json'
          - 'Content-Type: application/json'
---
apiVersion: ai.krateo.io/v1
kind: InferenceRun
metadata:
  name: example-inference-run-triton
  namespace: kserve-controller-system
spec:
  configRef:
    name: example-inference-config-triton
    namespace: kserve-controller-system
  timeoutSeconds: 3600
  parameters:
    input_table_name: azuretoolkit
    input_table_column_name: average
    key_name: resourceid
    key_value: "sample-vm"
    input_data_length: "512"
    output_table_name: kserve_controller_output_triton